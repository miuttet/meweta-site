<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>meweta</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="wrapper">

    <header>
      <h1 class="site-title"><a href="index.html">meweta</a></h1>
      <nav>
        <a href="index.html" class="active">home</a>
        <a href="about.html">about</a>
        <a href="gigs.html">gigs</a>
        <a href="mixes.html">mixes</a>
        <a href="caress.html">caress</a>
      </nav>
    </header>

    <main>

      <div class="section-label">caress</div>
      <ul class="gig-list" id="home-caress-list"></ul>

      <hr>

      <div class="section-label">upcoming gigs</div>
      <ul class="gig-list" id="home-upcoming-list"></ul>

      <hr>

      <div class="section-label">recent gigs</div>
      <ul class="gig-list" id="home-recent-list"></ul>

      <hr>

      <div class="section-label">latest mix</div>
      <ul class="mix-list">
        <li class="mix-item">
          <div class="mix-header">
            <span class="mix-title">meweta at niwa S4</span>
            <span class="mix-meta">2025.08.09</span>
          </div>
          <div class="mix-embed">
            <iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/soundcloud%253Atracks%253A2160206823&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe>
          </div>
        </li>
      </ul>

    </main>

    <footer>
      &copy; meweta
    </footer>

  </div>
  <script src="js/gigs-data.js"></script>
  <script>
    (function() {
      var today = new Date();
      today.setHours(0, 0, 0, 0);

      var caressList = document.getElementById('home-caress-list');
      var upcomingList = document.getElementById('home-upcoming-list');
      var recentList = document.getElementById('home-recent-list');

      var upcomingCaress = [];
      var upcoming = [];
      var past = [];

      GIGS.forEach(function(gig) {
        var gigDate = new Date(gig.date);
        gigDate.setHours(0, 0, 0, 0);
        if (gigDate >= today) {
          if (gig.isCaress) {
            upcomingCaress.push(gig);
          } else {
            upcoming.push(gig);
          }
        } else {
          past.push(gig);
        }
      });

      function makeGigLi(gig) {
        var li = document.createElement('li');
        li.className = 'gig-item no-flyer';
        li.innerHTML =
          '<div class="gig-body">' +
            '<div class="gig-info">' +
              '<span class="gig-event">' + gig.event + '</span>' +
              '<span class="gig-venue">' + gig.venue + '</span>' +
            '</div>' +
            '<span class="gig-date">' + gig.date.replace(/-/g, '.') + '</span>' +
          '</div>';
        return li;
      }

      function makeEmptyLi(msg) {
        var li = document.createElement('li');
        li.className = 'gig-item no-flyer';
        li.innerHTML = '<div class="gig-body"><div class="gig-info"><span class="gig-event no-events">' + msg + '</span></div></div>';
        return li;
      }

      // caress
      if (upcomingCaress.length === 0) {
        caressList.appendChild(makeEmptyLi('— no upcoming events'));
      } else {
        upcomingCaress.forEach(function(gig) {
          caressList.appendChild(makeGigLi(gig));
        });
      }
      var caressMore = document.createElement('li');
      caressMore.className = 'gig-item no-flyer';
      caressMore.innerHTML = '<div class="gig-body"><div class="gig-info"><span class="gig-event"><a href="caress.html">→ caress</a></span></div></div>';
      caressList.appendChild(caressMore);

      // upcoming gigs
      if (upcoming.length === 0) {
        upcomingList.appendChild(makeEmptyLi('— no upcoming events'));
      } else {
        upcoming.forEach(function(gig) {
          upcomingList.appendChild(makeGigLi(gig));
        });
      }

      // recent gigs（過去3件）
      past.slice(0, 3).forEach(function(gig) {
        recentList.appendChild(makeGigLi(gig));
      });
      if (past.length > 0) {
        var more = document.createElement('li');
        more.className = 'gig-item no-flyer';
        more.innerHTML = '<div class="gig-body"><div class="gig-info"><span class="gig-event"><a href="gigs.html">→ all gigs</a></span></div></div>';
        recentList.appendChild(more);
      }
    })();
  </script>
</body>
</html>
